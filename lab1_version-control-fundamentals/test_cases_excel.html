<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3CX Report Test Cases - Excel Export</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .export-section {
            text-align: center;
            margin-bottom: 30px;
        }
        .btn {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
            transition: background-color 0.3s;
        }
        .btn:hover {
            background-color: #0056b3;
        }
        .btn-success {
            background-color: #28a745;
        }
        .btn-success:hover {
            background-color: #1e7e34;
        }
        .info-box {
            background-color: #e9ecef;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
            font-size: 12px;
        }
        th {
            background-color: #f8f9fa;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        .status {
            margin-top: 20px;
            padding: 10px;
            border-radius: 5px;
            display: none;
        }
        .status.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>3CX Report Function - Test Cases Export</h1>
        
        <div class="info-box">
            <h3>ðŸ“‹ Test Cases Summary</h3>
            <p><strong>Total Test Cases:</strong> 15</p>
            <p><strong>High Priority:</strong> 8 test cases</p>
            <p><strong>Medium Priority:</strong> 7 test cases</p>
            <p><strong>Regression Tests:</strong> 2 test cases</p>
        </div>

        <div class="export-section">
            <h3>Export Options</h3>
            <button class="btn" onclick="exportToExcel()">ðŸ“Š Export to Excel (.xlsx)</button>
            <button class="btn btn-success" onclick="exportToCSV()">ðŸ“„ Export to CSV</button>
        </div>

        <div id="status" class="status"></div>

        <div class="table-container">
            <h3>Test Cases Preview</h3>
            <table id="testCasesTable">
                <thead>
                    <tr>
                        <th>Test Case ID</th>
                        <th>Test Case Name</th>
                        <th>Test Data</th>
                        <th>Preconditions</th>
                        <th>Test Steps</th>
                        <th>Expected Result</th>
                        <th>Priority</th>
                        <th>IsRegression</th>
                    </tr>
                </thead>
                <tbody id="testCasesBody">
                    <!-- Data will be populated by JavaScript -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Test Cases Data
        const testCasesData = [
            {
                "Test Case ID": "TC_3CX_001",
                "Test Case Name": "Verify 3CX Report Generation with Valid Date Range",
                "Test Data": "Start Date: 2024-01-01, End Date: 2024-01-31",
                "Preconditions": "1. User logged in with admin privileges\n2. 3CX system is integrated and operational\n3. Call data exists for the specified period",
                "Test Steps": "1. Navigate to Reports section\n2. Select \"3CX Report\" option\n3. Enter valid start date (2024-01-01)\n4. Enter valid end date (2024-01-31)\n5. Click \"Generate Report\"",
                "Expected Result": "1. Report generates successfully\n2. Report displays 3CX call data for specified period\n3. Report includes all relevant 3CX metrics\n4. No error messages displayed",
                "Priority": "High",
                "IsRegression": "No"
            },
            {
                "Test Case ID": "TC_3CX_002",
                "Test Case Name": "Verify 3CX Report Generation with Invalid Date Range (Future Dates)",
                "Test Data": "Start Date: 2025-12-01, End Date: 2025-12-31",
                "Preconditions": "1. User logged in with admin privileges\n2. 3CX system is integrated and operational",
                "Test Steps": "1. Navigate to Reports section\n2. Select \"3CX Report\" option\n3. Enter future start date (2025-12-01)\n4. Enter future end date (2025-12-31)\n5. Click \"Generate Report\"",
                "Expected Result": "1. System displays appropriate error message\n2. Report generation is prevented\n3. Error message indicates invalid date range",
                "Priority": "High",
                "IsRegression": "No"
            },
            {
                "Test Case ID": "TC_3CX_003",
                "Test Case Name": "Verify 3CX Report Generation with Invalid Date Range (End Date Before Start Date)",
                "Test Data": "Start Date: 2024-01-31, End Date: 2024-01-01",
                "Preconditions": "1. User logged in with admin privileges\n2. 3CX system is integrated and operational",
                "Test Steps": "1. Navigate to Reports section\n2. Select \"3CX Report\" option\n3. Enter start date (2024-01-31)\n4. Enter end date (2024-01-01)\n5. Click \"Generate Report\"",
                "Expected Result": "1. System displays validation error\n2. Error message indicates end date must be after start date\n3. Report generation is prevented",
                "Priority": "High",
                "IsRegression": "No"
            },
            {
                "Test Case ID": "TC_3CX_004",
                "Test Case Name": "Verify 3CX Report Export to Excel Functionality",
                "Test Data": "Valid date range with existing data",
                "Preconditions": "1. User logged in with admin privileges\n2. 3CX report has been generated successfully\n3. Report contains data",
                "Test Steps": "1. Generate 3CX report with valid date range\n2. Verify report displays data\n3. Click \"Export to Excel\" button\n4. Check downloaded file",
                "Expected Result": "1. Excel file downloads successfully\n2. Excel file contains all report data\n3. Excel file format is correct (.xlsx)\n4. Data integrity maintained in Excel",
                "Priority": "High",
                "IsRegression": "No"
            },
            {
                "Test Case ID": "TC_3CX_005",
                "Test Case Name": "Verify 3CX Report with Empty Data Set",
                "Test Data": "Date range with no call data",
                "Preconditions": "1. User logged in with admin privileges\n2. 3CX system is integrated and operational\n3. No call data exists for specified period",
                "Test Steps": "1. Navigate to Reports section\n2. Select \"3CX Report\" option\n3. Enter date range with no data\n4. Click \"Generate Report\"",
                "Expected Result": "1. Report generates without errors\n2. Report displays appropriate \"No data found\" message\n3. Report structure is maintained\n4. Export option remains available",
                "Priority": "Medium",
                "IsRegression": "No"
            },
            {
                "Test Case ID": "TC_3CX_006",
                "Test Case Name": "Verify 3CX Report Access with Different User Roles (Admin)",
                "Test Data": "Valid credentials for admin user",
                "Preconditions": "1. Admin user account exists\n2. 3CX system is integrated and operational",
                "Test Steps": "1. Login with admin credentials\n2. Navigate to Reports section\n3. Verify 3CX Report option visibility\n4. Attempt to generate report",
                "Expected Result": "1. 3CX Report option is visible\n2. Admin can access and generate reports\n3. All report features are available",
                "Priority": "High",
                "IsRegression": "Yes"
            },
            {
                "Test Case ID": "TC_3CX_007",
                "Test Case Name": "Verify 3CX Report Access with Different User Roles (Agent)",
                "Test Data": "Valid credentials for agent user",
                "Preconditions": "1. Agent user account exists\n2. 3CX system is integrated and operational",
                "Test Steps": "1. Login with agent credentials\n2. Navigate to Reports section\n3. Check 3CX Report option visibility\n4. Attempt to access if visible",
                "Expected Result": "1. 3CX Report access follows defined permissions\n2. Appropriate access control is enforced\n3. Error message if access denied",
                "Priority": "High",
                "IsRegression": "Yes"
            },
            {
                "Test Case ID": "TC_3CX_008",
                "Test Case Name": "Verify 3CX Report Performance with Large Data Set",
                "Test Data": "Date range covering 6 months with high call volume",
                "Preconditions": "1. User logged in with admin privileges\n2. 3CX system contains large dataset\n3. System performance baseline established",
                "Test Steps": "1. Navigate to Reports section\n2. Select \"3CX Report\" option\n3. Enter 6-month date range\n4. Click \"Generate Report\"\n5. Monitor loading time",
                "Expected Result": "1. Report generates within acceptable time (<30 seconds)\n2. System remains responsive\n3. Report displays correctly\n4. No timeout errors",
                "Priority": "Medium",
                "IsRegression": "No"
            },
            {
                "Test Case ID": "TC_3CX_009",
                "Test Case Name": "Verify 3CX Report Filter Functionality by Call Type",
                "Test Data": "Call type filters: All, Inbound, Outbound, Campaign",
                "Preconditions": "1. User logged in with admin privileges\n2. 3CX report generated with mixed call types\n3. Data contains all call types",
                "Test Steps": "1. Generate 3CX report\n2. Apply \"Inbound\" filter\n3. Verify results\n4. Apply \"Outbound\" filter\n5. Verify results\n6. Apply \"Campaign\" filter\n7. Verify results",
                "Expected Result": "1. Filter shows only selected call type\n2. Data accuracy maintained\n3. Filter options work correctly\n4. \"All\" option shows complete data",
                "Priority": "High",
                "IsRegression": "No"
            },
            {
                "Test Case ID": "TC_3CX_010",
                "Test Case Name": "Verify 3CX Report Integration Status Check",
                "Test Data": "N/A",
                "Preconditions": "1. User logged in with admin privileges\n2. Access to system configuration",
                "Test Steps": "1. Navigate to Reports section\n2. Check 3CX integration status\n3. Attempt to generate report\n4. Verify connection indicators",
                "Expected Result": "1. System displays 3CX connection status\n2. Integration status is clearly indicated\n3. Appropriate messages for connection issues",
                "Priority": "Medium",
                "IsRegression": "No"
            },
            {
                "Test Case ID": "TC_3CX_011",
                "Test Case Name": "Verify 3CX Report Data Accuracy Against Source",
                "Test Data": "Sample call records from 3CX system",
                "Preconditions": "1. User logged in with admin privileges\n2. Access to 3CX source data\n3. Test data set identified",
                "Test Steps": "1. Generate 3CX report for specific period\n2. Compare report data with 3CX source\n3. Verify call details, duration, timestamps\n4. Check calculation accuracy",
                "Expected Result": "1. Report data matches 3CX source\n2. All calculations are accurate\n3. No data discrepancies found\n4. Timestamps are correctly formatted",
                "Priority": "High",
                "IsRegression": "No"
            },
            {
                "Test Case ID": "TC_3CX_012",
                "Test Case Name": "Verify 3CX Report Search and Filter Functionality",
                "Test Data": "Search terms: agent names, phone numbers, call IDs",
                "Preconditions": "1. User logged in with admin privileges\n2. 3CX report generated with searchable data",
                "Test Steps": "1. Generate 3CX report\n2. Use search function with agent name\n3. Use search function with phone number\n4. Use search function with call ID\n5. Test search with invalid terms",
                "Expected Result": "1. Search returns accurate results\n2. Search is case-insensitive\n3. No results message for invalid terms\n4. Search performance is acceptable",
                "Priority": "Medium",
                "IsRegression": "No"
            },
            {
                "Test Case ID": "TC_3CX_013",
                "Test Case Name": "Verify 3CX Report Pagination with Large Result Sets",
                "Test Data": "Dataset with 1000+ records",
                "Preconditions": "1. User logged in with admin privileges\n2. Large dataset available for reporting period",
                "Test Steps": "1. Generate 3CX report with large dataset\n2. Verify pagination controls appear\n3. Navigate through pages\n4. Verify record count per page\n5. Test first/last page navigation",
                "Expected Result": "1. Pagination works correctly\n2. Record count is accurate\n3. Navigation is smooth\n4. Data integrity maintained across pages",
                "Priority": "Medium",
                "IsRegression": "No"
            },
            {
                "Test Case ID": "TC_3CX_014",
                "Test Case Name": "Verify 3CX Report Error Handling for System Failures",
                "Test Data": "Simulated 3CX system unavailability",
                "Preconditions": "1. User logged in with admin privileges\n2. Ability to simulate system failures",
                "Test Steps": "1. Navigate to Reports section\n2. Simulate 3CX system disconnection\n3. Attempt to generate report\n4. Verify error handling",
                "Expected Result": "1. System displays appropriate error message\n2. User is informed of system unavailability\n3. Application remains stable\n4. Recovery options are provided",
                "Priority": "High",
                "IsRegression": "No"
            },
            {
                "Test Case ID": "TC_3CX_015",
                "Test Case Name": "Verify 3CX Report Real-time Data Updates",
                "Test Data": "Live call data",
                "Preconditions": "1. User logged in with admin privileges\n2. Active calls in progress\n3. Real-time data sync enabled",
                "Test Steps": "1. Generate 3CX report\n2. Note current call count\n3. Initiate new calls\n4. Refresh or regenerate report\n5. Verify data updates",
                "Expected Result": "1. Report reflects current call data\n2. Real-time updates are accurate\n3. Refresh functionality works\n4. No data lag observed",
                "Priority": "Medium",
                "IsRegression": "No"
            }
        ];

        // Populate table
        function populateTable() {
            const tbody = document.getElementById('testCasesBody');
            tbody.innerHTML = '';
            
            testCasesData.forEach(testCase => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${testCase['Test Case ID']}</td>
                    <td>${testCase['Test Case Name']}</td>
                    <td>${testCase['Test Data']}</td>
                    <td>${testCase['Preconditions'].replace(/\n/g, '<br>')}</td>
                    <td>${testCase['Test Steps'].replace(/\n/g, '<br>')}</td>
                    <td>${testCase['Expected Result'].replace(/\n/g, '<br>')}</td>
                    <td>${testCase['Priority']}</td>
                    <td>${testCase['IsRegression']}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // Export to Excel
        function exportToExcel() {
            try {
                const wb = XLSX.utils.book_new();
                const ws = XLSX.utils.json_to_sheet(testCasesData);
                
                // Set column widths
                const colWidths = [
                    {wch: 15}, // Test Case ID
                    {wch: 50}, // Test Case Name
                    {wch: 30}, // Test Data
                    {wch: 40}, // Preconditions
                    {wch: 50}, // Test Steps
                    {wch: 50}, // Expected Result
                    {wch: 10}, // Priority
                    {wch: 12}  // IsRegression
                ];
                ws['!cols'] = colWidths;
                
                XLSX.utils.book_append_sheet(wb, ws, "3CX Report Test Cases");
                
                // Generate filename with timestamp
                const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');
                const filename = `3CX_Report_Test_Cases_${timestamp}.xlsx`;
                
                XLSX.writeFile(wb, filename);
                
                showStatus('Excel file exported successfully!', 'success');
            } catch (error) {
                showStatus('Error exporting to Excel: ' + error.message, 'error');
            }
        }

        // Export to CSV
        function exportToCSV() {
            try {
                const wb = XLSX.utils.book_new();
                const ws = XLSX.utils.json_to_sheet(testCasesData);
                
                XLSX.utils.book_append_sheet(wb, ws, "Test Cases");
                
                // Generate filename with timestamp
                const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');
                const filename = `3CX_Report_Test_Cases_${timestamp}.csv`;
                
                XLSX.writeFile(wb, filename, {bookType: 'csv'});
                
                showStatus('CSV file exported successfully!', 'success');
            } catch (error) {
                showStatus('Error exporting to CSV: ' + error.message, 'error');
            }
        }

        // Show status message
        function showStatus(message, type) {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
            statusDiv.style.display = 'block';
            
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 5000);
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            populateTable();
        });
    </script>
</body>
</html>